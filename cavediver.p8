pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
 game_over=false
 make_cave()
 make_player()
end

function _update()
 if (not game_over) then
  update_cave()
  move_player()
  check_hit()
 else
  if (btnp(5)) _init() --restart
 end
end

function _draw()
 cls()
 draw_cave()
 draw_player()

 if (game_over) then
 	print("game over!",44,44,7)
  print("your score: "..player.score,34,54,7)
  print("press ❎ to play again!",18,72,6)
 else
  print("score: "..player.score,2,2,7)
 end
end
-->8
function make_player()
 player={}
 player.x=24
 player.y=60
 player.dy=0
 player.rise=1
 player.fall=2
 player.dead=3
 player.speed=3
 player.score=0
end

function draw_player()
 if (game_over) then
  spr(player.dead,player.x,player.y)
 elseif (player.dy<0) then
  spr(player.rise,player.x,player.y)
 else
  spr(player.fall,player.x,player.y)
 end
end 

function move_player()
 gravity=0.2
 player.dy+=gravity
 
 --jump
 if(btnp(2)) then
  player.dy=-3
  sfx(0)
 end
 
 player.y+=player.dy

 player.score+=player.speed
end

function check_hit()
 for i=player.x,player.x+7 do
  if (cave[i+1].top>player.y
   or cave[i+1].btm<player.y+7) then
   game_over=true
   sfx(1)
  end
 end
end
-->8
function make_cave()
 cave={{["top"]=5,["btm"]=119}}
 top=45 --lowest ceiling
 btm=85 --highest ceiling
end

function update_cave()
 if(#cave>player.speed) then
  for i=1, player.speed do
   del(cave,cave[1])
  end
 end
 
 while (#cave<128) do
  local col={}
  local up=flr(rnd(7)-3)
  local dwn=flr(rnd(7)-3)
  col.top=mid(3,cave[#cave].top+up,top)
  col.btm=mid(btm,cave[#cave].btm+dwn,124)
  add(cave,col)
 end
end

function draw_cave()
 top_color=1
 btm_color=1
 for i=1,#cave do
  line(i-1,0,i-1,cave[i].top,top_color)
  line(i-1,127,i-1,cave[i].btm,btm_color)
 end
end
__gfx__
0000000000aaaa0000aaaa0000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000aaaaaa00aaaaaa008888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700aaa0a0aaaaa0a0aa88808088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aaaaaaaaaaaaaaaa88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aaa000aaaaa00aaa88080888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000aaa0aa00aa00aa008808080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaaa0000aaaa0000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11177117711771777177711111111177717171777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11711171117171717171111711111111717171717111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777171117171771177111111111177717771717111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11117171117171717171111711111171111171717111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11771117717711717177711111111177711171777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11110111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110111111111111111111111
11110010111111111111111111111111111111111111111111111111111001111111111111111111111111111111111111111100110011111111111111111111
11100010111111111111111111111111111111111111111111111111110001111111111111111111111111111111101111111000100001111111111111111111
11000000011111111111111111111111111111111111111111111111010001111111111111111111111111111110100011110000000001111111111111111111
11000000011111111111111111111111111111111111111111111111000000111111111101111111111111111100000011110000000000111111111111111111
10000000011011111111111111111111111111111111111011111110000000111111111101111111111111011100000011100000000000101011111111111111
00000000001011111111111111111111111111111111111011101000000000111111110100101110111111000100000000100000000000100011111111111111
00000000000010111111111111111111111111111111111011101000000000011111110000001010011110000000000000100000000000000011110011011111
00000000000000111111111111111011101111110001110001000000000000011110100000001010011110000000000000000000000000000001100011001011
00000000000000011011111110011001001111100000110001000000000000000100100000000000011000000000000000000000000000000001000001000000
00000000000000010001111100000000000101100000010001000000000000000000100000000000001000000000000000000000000000000000000000000000
00000000000000000001111100000000000000100000000000000000000000000000000000000000001000000000000000000000000000000000000000000000
00000000000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000009aa900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000aaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000009aa0a0a9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000009aa000a9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000aaa0aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000009aa900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111001100000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111001100000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001101000101111011110000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001101000111111111110000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111110000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111000100000
00000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000011111111111111111111010100001
00000000000000000000000000000000000000000000000000000000110000010000000010000000000000000000000001111111111111111111111010111111
00000000000000000000000000000000000000000000000000100111110001010000000010000000000000000001010001111111111111111111111111111111
00000000000000000000000000000000000000000000000000110111111111111000000010000000000000000011010011111111111111111111111111111111
00000000000000000000000000000000000000000000000110111111111111111000000111000000000000000011011011111111111111111111111111111111
00000000000000000000000000000000000000000000000111111111111111111000000111000000000000000011111111111111111111111111111111111111
00000000000000000000000000000000000000000000101111111111111111111100000111000000000010100111111111111111111111111111111111111111
00000000000000000000000000000000000000011000111111111111111111111100001111100000000110110111111111111111111111111111111111111111
00000000000000000000000000000000000000011001111111111111111111111100001111110000000110110111111111111111111111111111111111111111
00000000000000000000000000000000000000111101111111111111111111111110111111110000011111111111111111111111111111111111111111111111
00000000000000000000000000001100000001111111111111111111111111111111111111111100011111111111111111111111111111111111111111111111
00000000000100000000000000001100100001111111111111111111111111111111111111111101111111111111111111111111111111111111111111111111
00000000000100000000000000101100100111111111111111111111111111111111111111111101111111111111111111111111111111111111111111111111
00010000001100000000000001111110101111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
00010000001110000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
00010000001110000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
00111000011111000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
00111000011111000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
01111000111111000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111

__sfx__
000400000705009050000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000100002000020000000000000030000000000000000000000000
00100000240501d00018050090000e050070000704007030060300603006020060200602005010050100501000000000000000000000000000000000000000000000000000000000000000000000000000000000
